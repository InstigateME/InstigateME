# Active Context

## –¢–µ–∫—É—â–∏–π —Ñ–æ–∫—É—Å
- –£–±—Ä–∞–Ω–∞ –≥–ª–æ–±–∞–ª—å–Ω–∞—è –∏–Ω–¥–∏–∫–∞—Ü–∏—è –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è (–æ–≤–µ—Ä–ª–µ–π/–±–∞–Ω–Ω–µ—Ä) –Ω–∞ —É—Ä–æ–≤–Ω–µ App.vue –∏ –≤ –∏–≥—Ä–æ–≤—ã—Ö —Ñ–∞–∑–∞—Ö.
- –û—Å—Ç–∞–≤–ª–µ–Ω –ª–æ–∫–∞–ª—å–Ω—ã–π Pop/–±–∞–Ω–Ω–µ—Ä —Ç–æ–ª—å–∫–æ –≤ –¥–≤—É—Ö –º–µ—Å—Ç–∞—Ö:
  1) –õ–æ–±–±–∏: –ª–æ–∫–∞–ª—å–Ω—ã–π –±–∞–Ω–Ω–µ—Ä reconnect-banner –ø—Ä–∏ uiConnecting.
  2) –ò–≥—Ä–æ–≤–æ–µ –ø–æ–ª–µ (GameField): —É–±—Ä–∞–Ω—ã –≤—Å–µ –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –±–ª–æ–∫–∏ reconnect-info; –ª–æ–±–±–∏ –≤–Ω—É—Ç—Ä–∏ GameField –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–æ–Ω—Ç–µ–Ω—Ç —Ç–æ–ª—å–∫–æ –ø—Ä–∏ connected.

## –ù–µ–¥–∞–≤–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
- src/App.vue: —É–¥–∞–ª–µ–Ω –≥–ª–æ–±–∞–ª—å–Ω—ã–π –æ–≤–µ—Ä–ª–µ–π .rehydration-overlay, —Å–≤—è–∑–∞–Ω–Ω—ã–π —Å uiConnecting.
- src/components/GameField.vue:
  - –£–¥–∞–ª–µ–Ω—ã –≤—Å–µ –±–ª–æ–∫–∏:
    - `<div v-if="gameStore.connectionStatus !== 'connected'" class="reconnect-info">...</div>`
    - –≤ —Ñ–∞–∑–∞—Ö drawing_question, voting/secret_voting, betting, answering, guessing, selecting_winners, results, game_over.
  - –í —Å–µ–∫—Ü–∏–∏ "–õ–æ–±–±–∏" –≤–Ω—É—Ç—Ä–∏ GameField –∑–∞–º–µ–Ω–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –Ω–∞ `<template v-if="gameStore.connectionStatus === 'connected'">`, —á—Ç–æ–±—ã –ø—Ä–∏ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –Ω–∏—á–µ–≥–æ –ª–∏—à–Ω–µ–≥–æ –Ω–µ —Ä–µ–Ω–¥–µ—Ä–∏–ª–æ—Å—å (–±–µ–∑ –≥–ª–æ–±–∞–ª—å–Ω–æ–π –∏–Ω–¥–∏–∫–∞—Ü–∏–∏).
- src/components/Lobby.vue: –ª–æ–∫–∞–ª—å–Ω—ã–π –±–∞–Ω–Ω–µ—Ä reconnect-banner —Å–æ—Ö—Ä–∞–Ω–µ–Ω –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ –≤ –ª–æ–±–±–∏.

## –†–µ—à–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã
- –í—ã–ø–æ–ª–Ω–µ–Ω–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ: ‚Äú–£–¥–∞–ª–∏—Ç—å —É–ø–æ–º–∏–Ω–∞–Ω–∏–µ –æ –≥–ª–æ–±–∞–ª—å–Ω–æ–π –∏–Ω–¥–∏–∫–∞—Ü–∏–∏, –æ—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ Pop –≤ –õ–æ–±–±–∏ –∏ –ò–≥—Ä–µ; –≤ –≥–ª–∞–≤–Ω–æ–º –º–µ–Ω—é ‚Äî –±–µ–∑ Pop; –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –∏–∑ –≥–ª–∞–≤–Ω–æ–≥–æ –º–µ–Ω—é –≤ –ª–æ–±–±–∏ ‚Äî Pop –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞—á–∏–Ω–∞—è —Å –ª–æ–±–±–∏ –∏ –≤ —Å–∞–º–æ–π –∏–≥—Ä–µ‚Äù.
- –ò—Å–∫–ª—é—á–µ–Ω–∞ –¥—É–±–ª–∏—Ä—É—é—â–∞—è –≥–ª–æ–±–∞–ª—å–Ω–∞—è –∏–Ω–¥–∏–∫–∞—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –º–æ–≥–ª–∞ –ø–µ—Ä–µ–∫—Ä—ã–≤–∞—Ç—å UI.

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏
- –í–∏–∑—É–∞–ª—å–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å: –≤ MainMenu.vue –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –ª—é–±—ã–µ –±–∞–Ω–Ω–µ—Ä—ã/–æ–≤–µ—Ä–ª–µ–∏ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è.
Date: 2025-08-06

## –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ: —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å PeerJS, –ø–æ—Ç–µ—Ä—è —Å–≤—è–∑–∏ –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ (2025-08-06)
–ö–æ—Ä–Ω–µ–≤–∞—è –ø—Ä–∏—á–∏–Ω–∞:
- –•–æ—Å—Ç –ø—Ä–∏ –ø–æ—Ç–µ—Ä–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å —Å–∏–≥–Ω–∞–ª—å–Ω—ã–º —Å–µ—Ä–≤–µ—Ä–æ–º –ø–µ—Ä–µ—Å–æ–∑–¥–∞–≤–∞–ª—Å—è —Å –ù–û–í–´–ú peerId (–ª–æ–≥: "üÜï Host created with new ID ..."), –∫–ª–∏–µ–Ω—Ç—ã –æ—Å—Ç–∞–≤–∞–ª–∏—Å—å –ø—Ä–∏–≤—è–∑–∞–Ω—ã –∫ —Å—Ç–∞—Ä–æ–º—É ID –∏ –Ω–µ –º–æ–≥–ª–∏ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è.
- Heartbeat –ø—Ä–æ–¥–æ–ª–∂–∞–ª –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å—Å—è –æ—Ç –Ω–æ–≤–æ–≥–æ —Ö–æ—Å—Ç–∞, –Ω–æ –∫–ª–∏–µ–Ω—Ç—ã –µ–≥–æ –Ω–µ –ø–æ–ª—É—á–∞–ª–∏ –∏–∑‚Äë–∑–∞ —Ä–∞–∑—Ä—ã–≤–∞ –∫–æ–Ω–Ω–µ–∫—Ç–∞.
- –ù–µ —Ö–≤–∞—Ç–∞–ª–æ –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏/—Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ hostId –∏ –º—è–≥–∫–æ–π –ø–æ–ø—ã—Ç–∫–∏ —Ä–µ–∫–æ–Ω–Ω–µ–∫—Ç–∞ –∫ —Ç–æ–º—É –∂–µ ID —Å–æ —Å—Ç–æ—Ä–æ–Ω—ã –∫–ª–∏–µ–Ω—Ç–æ–≤.

–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤ –∫–æ–¥–µ:
- src/services/peerService.ts:
  - createHost(roomId): –µ—Å–ª–∏ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–π hostId –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç, —Å–æ–∑–¥–∞—ë–º –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π ID –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ–º–Ω–∞—Ç—ã: "room-${roomId}" –≤–º–µ—Å—Ç–æ —Å–ª—É—á–∞–π–Ω–æ–≥–æ UUID. –≠—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω—ã–π hostId –º–µ–∂–¥—É —Ä–µ–∫–æ–Ω–Ω–µ–∫—Ç–∞–º–∏.
  - –ü—Ä–∏ –æ—à–∏–±–∫–∞—Ö –≤–∏–¥–∞ unavailable-id/server-error/network –¥–ª—è —Ö–æ—Å—Ç–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –º—è–≥–∫–æ–µ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏–µ Peer —Å –¢–ï–ú –ñ–ï deterministic ID, –∞ –Ω–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ —Å–ª—É—á–∞–π–Ω–æ–≥–æ.
  - setAsHost(): –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è–µ–º —Å—Ç–∞–±–∏–ª—å–Ω—ã–π hostId –¥–ª—è –∫–æ–º–Ω–∞—Ç—ã –≤ storageSafe.
  - handleHostDisconnection() –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –º—è–≥–∫—É—é –ø–æ–ø—ã—Ç–∫—É –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Ç–æ–º—É –∂–µ hostId –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –∫–æ—Ä–æ—Ç–∫–æ–≥–æ —Ç–∞–π–º–∞—É—Ç–∞, –¥–æ –∑–∞–ø—É—Å–∫–∞ –º–∏–≥—Ä–∞—Ü–∏–∏.
  - –û–±—Ä–∞–±–æ—Ç—á–∏–∫ 'disconnected' —É —Ö–æ—Å—Ç–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç peer.reconnect(), —á—Ç–æ–±—ã –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å —Ç–µ–º –∂–µ id.
–û–∂–∏–¥–∞–µ–º—ã–π —ç—Ñ—Ñ–µ–∫—Ç:
- –ü—Ä–∏ –∫—Ä–∞—Ç–∫–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å–±–æ—è—Ö —Å–∏–≥–Ω–∞–ª—å–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ —Ö–æ—Å—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø—Ä–µ–∂–Ω–∏–π ID, –∫–ª–∏–µ–Ω—Ç—ã –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç –≤–∏–¥–µ—Ç—å —Ç–æ—Ç –∂–µ hostId –∏ —É—Å–ø–µ—à–Ω–æ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–∞—é—Ç—Å—è.
- –ò—Å–∫–ª—é—á–µ–Ω—ã —Å–∏—Ç—É–∞—Ü–∏–∏, –∫–æ–≥–¥–∞ —Ö–æ—Å—Ç ¬´—Ç–∏—Ö–æ¬ª –º–µ–Ω—è–µ—Ç ID –∏ —Å–µ—Ç—å ¬´—Ä–∞—Å—Å—ã–ø–∞–µ—Ç—Å—è¬ª.

–ü—Ä–æ–≤–µ—Ä–∫–∞:
- –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Ö–æ—Å—Ç–∞/—Å–∏–º—É–ª–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Ç–µ—Ä—é —Å–≤—è–∑–∏. –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ:
  - –•–æ—Å—Ç –æ—Å—Ç–∞—ë—Ç—Å—è —Å —Ç–µ–º –∂–µ ID (room-<ROOM_ID> –∏–ª–∏ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–π).
  - –ö–ª–∏–µ–Ω—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–∞—é—Ç—Å—è –±–µ–∑ —Å–º–µ–Ω—ã hostId.

## –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ: —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –∫–æ–ª–æ–¥ –≤–æ–ø—Ä–æ—Å–æ–≤ –ø–æ —Ä–∞—É–Ω–¥–∞–º (2025-08-06)
- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ —Å—Ç—Ä–æ–≥–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –≤–æ–ø—Ä–æ—Å–æ–≤ –Ω–∞ –¥–≤–µ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–µ –∫–æ–ª–æ–¥—ã: basicDeck –∏ advancedDeck.
- –ü–µ—Ä–µ—Ç–∞—Å–æ–≤–∫–∞ Fisher‚ÄìYates –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –û–î–ò–ù —Ä–∞–∑ –Ω–∞ —Å—Ç–∞—Ä—Ç–µ –∏–≥—Ä—ã –¥–ª—è –∫–∞–∂–¥–æ–π –∫–æ–ª–æ–¥—ã.
- –í —Ö–æ–¥–µ –∏–≥—Ä—ã –∫–æ–ª–æ–¥–∞ –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è –ø–æ —Ç–µ–∫—É—â–µ–º—É —Ä–µ–∂–∏–º—É (currentMode: –Ω–µ—á–µ—Ç–Ω—ã–µ —Ä–∞—É–Ω–¥—ã ‚Äî basic, —á–µ—Ç–Ω—ã–µ ‚Äî advanced), –≤–æ–ø—Ä–æ—Å—ã –±–µ—Ä—É—Ç—Å—è —Ç–æ–ª—å–∫–æ –∏–∑ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–π –∫–æ–ª–æ–¥—ã.
- –ü—Ä–∏ –∏—Å—á–µ—Ä–ø–∞–Ω–∏–∏ –∞–∫—Ç–∏–≤–Ω–æ–π –∫–æ–ª–æ–¥—ã ‚Äî –æ–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏–∑ src/data/questions.ts –∏ –∑–∞–Ω–æ–≤–æ –ø–µ—Ä–µ—Ç–∞—Å–æ–≤—ã–≤–∞–µ—Ç—Å—è, –∫–∞–∫ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–æ.

–ó–∞—Ç—Ä–æ–Ω—É—Ç—ã–µ –º–µ—Å—Ç–∞:
- src/stores/gameStore.ts:
  - –î–æ–±–∞–≤–ª–µ–Ω—ã refs: basicDeck, advancedDeck.
  - initializeGame(): –∑–∞–≥—Ä—É–∂–∞–µ—Ç –º–æ–¥—É–ª—å '@/data/questions', —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –∏ –ø–µ—Ä–µ–º–µ—à–∏–≤–∞–µ—Ç –æ–±–µ –∫–æ–ª–æ–¥—ã; –≤ gameState.questionCards –∫–ª–∞–¥–µ—Ç—Å—è snapshot –∞–∫—Ç–∏–≤–Ω–æ–π –∫–æ–ª–æ–¥—ã –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ UI.
  - drawCard(): –≤—ã—Ç—è–≥–∏–≤–∞–µ—Ç –∫–∞—Ä—Ç—É –∏–∑ –∞–∫—Ç–∏–≤–Ω–æ–π –∫–æ–ª–æ–¥—ã, –ø—Ä–∏ –ø—É—Å—Ç–æ–π ‚Äî –ª–µ–Ω–∏–≤–æ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ—Ç –∏ –ø–µ—Ä–µ—Ç–∞—Å–æ–≤—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—É—é –∫–æ–ª–æ–¥—É; —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç gameState.currentQuestion –∏ snapshot questionCards.
  - finishRoundHostOnly(): –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞—É–Ω–¥ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç snapshot –∞–∫—Ç–∏–≤–Ω–æ–π –∫–æ–ª–æ–¥—ã; –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∏–≥—Ä—ã —Ç–µ–ø–µ—Ä—å –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ª–∏–º–∏—Ç–æ–º —Ä–∞—É–Ω–¥–æ–≤ (–∫–æ–ª–æ–¥—ã –º–æ–≥—É—Ç –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è).
- –ü–æ–≤–µ–¥–µ–Ω–∏–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º–∏: ¬´–í–æ–ø—Ä–æ—Å—ã –ø–æ —Ä–∞—É–Ω–¥–∞–º –¥–æ–ª–∂–Ω—ã –¥–µ–ª–∏—Ç—å—Å—è; –Ω–µ–ª—å–∑—è —Å–º–µ—à–∏–≤–∞—Ç—å; —á–µ—Ä–µ–¥—É—é—Ç—Å—è —Ä–∞—É–Ω–¥—ã; –ø—Ä–∏ –æ–∫–æ–Ω—á–∞–Ω–∏–∏ –∫–æ–ª–æ–¥—ã ‚Äî –ø–µ—Ä–µ—Ç–∞—Å–æ–≤–∞—Ç—å –∏ –Ω–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ¬ª.

–û–∂–∏–¥–∞–µ–º—ã–π —ç—Ñ—Ñ–µ–∫—Ç:
- –í–æ–ø—Ä–æ—Å—ã —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –Ω–µ —Å–º–µ—à–∏–≤–∞—é—Ç—Å—è –º–µ–∂–¥—É —Ä–∞—É–Ω–¥–∞–º–∏.
- –ò–≥—Ä–∞ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∏–¥—Ç–∏ –¥–∞–∂–µ –ø—Ä–∏ –∏—Å—á–µ—Ä–ø–∞–Ω–∏–∏ –æ–¥–Ω–æ–π –∏–∑ –∫–æ–ª–æ–¥ ‚Äî –æ–Ω–∞ –ø–µ—Ä–µ–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

Focus: –ü–æ—á–∏–Ω–∫–∞ —Ä–∞–∑–≤–∞–ª–∞ —Å–µ—Ç–∏ –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —Ö–æ—Å—Ç–∞ (PeerJS) –∏ —É–ª—É—á—à–µ–Ω–∏–µ –ª–æ–≥–∏–∫–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è/–¥–∏—Å–∫‡§µ‡§∞‡•Ä/—ç–ª–µ–∫—Ü–∏–∏ —Ö–æ—Å—Ç–∞, —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ª–æ–∂–Ω—ã—Ö "Session successfully restored" –±–µ–∑ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–≥–æ –∫–æ–Ω–Ω–µ–∫—Ç–∞.

## –ù–∞–±–ª—é–¥–∞–µ–º–∞—è –ø—Ä–æ–±–ª–µ–º–∞ (—Å–∏–º–ø—Ç–æ–º—ã –∏–∑ –ª–æ–≥–æ–≤)

- –ü–æ—Å–ª–µ reload —Ö–æ—Å—Ç–∞ –∫–ª–∏–µ–Ω—Ç—ã –ø—ã—Ç–∞—é—Ç—Å—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å—Å—è –∏ –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ –≤—ã–±–∏—Ä–∞—é—Ç –∫–∞–Ω–¥–∏–¥–∞—Ç–∞ —Å min id: "3a8423b2-..." –∫–∞–∫ —Ö–æ—Å—Ç–∞.
- PeerJS –æ—Ç–≤–µ—á–∞–µ—Ç "Could not connect to peer ..." –¥–ª—è —ç—Ç–æ–≥–æ id: —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–π peer –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç (id —Å–º–µ–Ω–∏–ª—Å—è) –∏–ª–∏ –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω.
- –ê–ª–≥–æ—Ä–∏—Ç–º —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–≥–æ discovery —Å–Ω–æ–≤–∞ –≤—ã–±–∏—Ä–∞–µ—Ç —Ç–æ—Ç –∂–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã–π id, –∑–∞—Ç–µ–º 5 –Ω–µ—É–¥–∞—á–Ω—ã—Ö —Ä–µ–∫–æ–Ω–Ω–µ–∫—Ç–æ–≤ –∫ –æ–¥–Ω–æ–º—É peer.
- –í –∫–æ–Ω—Ü–µ –≤—ã–≤–æ–¥–∏—Ç—Å—è "Session successfully restored" –Ω–µ—Å–º–æ—Ç—Ä—è –Ω–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ state sync ‚Äî –ª–æ–∂–Ω–æ–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π —Å—Ç–∞—Ç—É—Å, —Å–µ—Ç—å –ª–æ–≥–∏—á–µ—Å–∫–∏ "—Ä–∞–∑–≤–∞–ª–∏–ª–∞—Å—å".

## –ö–æ—Ä–Ω–µ–≤—ã–µ –ø—Ä–∏—á–∏–Ω—ã

1) –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Å—Ç—Ä–æ–≥–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –∫–∞–Ω–¥–∏–¥–∞—Ç–∞-—Ö–æ—Å—Ç–∞ –ø–µ—Ä–µ–¥ –≤—ã–±–æ—Ä–æ–º (–¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π min id –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è –±–µ–∑ reachability).
2) –ù–µ—Ç blacklist-–∞ –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ –≤ —Ä–∞–º–∫–∞—Ö –æ–¥–Ω–æ–≥–æ discovery —Ü–∏–∫–ª–∞ ‚Äî –ø–æ–≤—Ç–æ—Ä—è–µ–º –ø–æ–ø—ã—Ç–∫–∏ –∫ –æ–¥–Ω–æ–º—É –∏ —Ç–æ–º—É –∂–µ peerId.
3) –õ–æ–≥–∏–∫–∞ "Session successfully restored" —Å—Ä–∞–±–∞—Ç—ã–≤–∞–ª–∞ –¥–æ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–ª—É—á–µ–Ω–∏—è –≤–∞–ª–∏–¥–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è (players/phase).
4) –í–æ–∑–º–æ–∂–µ–Ω –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π —Å—Ç–∞—Ä—Ç discovery (–≥–æ–Ω–∫–∏) –∏ –æ–ø–æ—Ä–∞ –Ω–∞ –∫—ç—à —è–∫–æ—Ä–Ω–æ–≥–æ —Å–Ω–∞–ø—à–æ—Ç–∞ –±–µ–∑ –∂–∏–≤–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏.
5) –ü—Ä–∏ reload —Ö–æ—Å—Ç–∞ peerId –º–æ–≥ –∏–∑–º–µ–Ω–∏—Ç—å—Å—è, –∞ –∫–ª–∏–µ–Ω—Ç—ã –ø—Ä–æ–¥–æ–ª–∂–∞–ª–∏ –∫–æ–Ω–Ω–µ–∫—Ç–∏—Ç—å—Å—è –∫ —Å—Ç–∞—Ä–æ–º—É id.

## –í–Ω–µ—Å—ë–Ω–Ω—ã–µ —Ñ–∏–∫—Å—ã (–∫–æ–¥)

–§–∞–π–ª: src/stores/gameStore.ts

1) –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π discovery —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –∏ blacklist:
   - –î–æ–±–∞–≤–ª–µ–Ω createCandidateBlacklist() –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ reachability –ø–µ—Ä–µ–¥ –≤—ã–±–æ—Ä–æ–º –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∫–∞–Ω–¥–∏–¥–∞—Ç–∞.
   - –ï—Å–ª–∏ lastKnownHost –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω ‚Äî –∑–∞–Ω–æ—Å–∏—Ç—Å—è –≤ blacklist –∏ –Ω–µ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è.
   - –ü–µ—Ä–µ–¥ fallback –ø–æ min id –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∫–æ—Ä–æ—Ç–∫–∏–π ping/handshake (host_discovery_request) —á–µ—Ä–µ–∑ —Ç–µ–∫—É—â–∏–π –æ—Å–Ω–æ–≤–Ω–æ–π peer –∏–ª–∏ –≤—Ä–µ–º–µ–Ω–Ω—ã–π peerjs instance —Å —Ç–∞–π–º–∞—É—Ç–æ–º 2s.

2) tryConnectToKnownHost –ø–µ—Ä–µ–ø–∏—Å–∞–Ω:
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π mainPeer –∏–∑ peerService, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –≥–æ–Ω–æ–∫ –∏ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö Peer.
   - –ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ —Ç–∞–π–º–∞—É—Ç—ã, –∑–∞–∫—Ä—ã—Ç–∏–µ temp —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π, –≤–æ–∑–≤—Ä–∞—Ç HostDiscoveryResponsePayload —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ isHost=true.

3) –°—Ç—Ä–æ–∂–µ –∫—Ä–∏—Ç–µ—Ä–∏–π —É—Å–ø–µ—à–Ω–æ–≥–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è:
   - "Session successfully restored" —Ç–µ–ø–µ—Ä—å —Å—Ç–∞–≤–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –ø–æ–ª—É—á–µ–Ω–æ –≤–∞–ª–∏–¥–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (–µ—Å—Ç—å –∏–≥—Ä–æ–∫–∏ –∏ –ø—Ä–æ—à—ë–ª sync).
   - –ò–Ω–∞—á–µ: connectionStatus='disconnected', —Ñ–∏–∫—Å–∞—Ü–∏—è –æ—à–∏–±–∫–∏ restore_state_missing.

4) Quick discovery:
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ—Å–Ω–æ–≤–Ω–æ–π peer; —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –≤ –ø—É–ª peerService, –∞ –Ω–µ –∑–∞–∫—Ä—ã–≤–∞—é—Ç—Å—è –±–µ–∑—É—Å–ª–æ–≤–Ω–æ.
   - –ö–æ—Ä–æ—Ç–∫–∏–π –æ–±—â–∏–π —Ç–∞–π–º–∞—É—Ç 2s –∏ –±–µ–∑–æ–ø–∞—Å–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ —Ç–æ–ª—å–∫–æ ¬´–Ω–µ—Å–æ—Ö—Ä–∞–Ω–∏–≤—à–∏—Ö—Å—è¬ª —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π.

5) Host restore path:
   - –ü—Ä–∏ restoreAsHost –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Ä–µ–º–∞–ø —Å—Ç–∞—Ä–æ–≥–æ hostId –Ω–∞ –Ω–æ–≤—ã–π, —Ä–∞—Å—Å—ã–ª–∫–∞ snapshot –∏ host_recovery_announcement, –∞ —Ç–∞–∫–∂–µ —Ä–µ–∑–µ—Ä–≤–Ω—ã–π new_host_id.
   - –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è snapshot –≤ storageSafe —Å TTL –¥–ª—è –±—ã—Å—Ç—Ä—ã—Ö reload.

6) –û–±—â–∞—è —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å:
   - –î–æ–±–∞–≤–ª–µ–Ω—ã –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞—â–∏—Ç–Ω—ã–µ –ª–æ–≥–∏, –≤–∞–ª–∏–¥–∞—Ü–∏—è litUpPlayerId, —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è phase/gameMode –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–∞—Ö, –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã state –∏ peer_list —Å —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π.

## –û–∂–∏–¥–∞–µ–º—ã–π —ç—Ñ—Ñ–µ–∫—Ç

- –ö–ª–∏–µ–Ω—Ç—ã –ø–µ—Ä–µ—Å—Ç–∞–Ω—É—Ç –∑–∞—Ü–∏–∫–ª–∏–≤–∞—Ç—å—Å—è –Ω–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ–º peerId; discovery –ø–µ—Ä–µ–±–∏—Ä–∞–µ—Ç –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ –∏ –≤—ã–±–∏—Ä–∞–µ—Ç —Ç–æ–ª—å–∫–æ –¥–æ—Å—Ç–∏–∂–∏–º–æ–≥–æ —Ö–æ—Å—Ç–∞.
- –ò—Å–∫–ª—é—á–µ–Ω—ã –ª–æ–∂–Ω—ã–µ ¬´—É—Å–ø–µ—Ö–∏¬ª –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –±–µ–∑ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è.
- –ü—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ —Ö–æ—Å—Ç–∞ –∫–ª–∏–µ–Ω—Ç—ã –ª–∏–±–æ –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞—é—Ç –µ–≥–æ —á–µ—Ä–µ–∑ announcement/snapshot, –ª–∏–±–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø—Ä–æ–≤–æ–¥—è—Ç –º–∏–≥—Ä–∞—Ü–∏—é –Ω–∞ –Ω–æ–≤–æ–≥–æ –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–Ω–æ–≥–æ –ª–∏–¥–µ—Ä–∞.

## –†–∏—Å–∫–∏/–¥–æ–ª–≥–∏

- –°—Ç–∞–±–∏–ª—å–Ω—ã–π —Ö–æ—Å—Ç ID –ª—É—á—à–µ –æ–±–µ—Å–ø–µ—á–∏–≤–∞—Ç—å —á–µ—Ä–µ–∑ —Å—Ç–∞–±–∏–ª—å–Ω—ã–π roomId -> persisted hostPeerId (—á–∞—Å—Ç–∏—á–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –≤ peerService.createHost(roomId)), –Ω–æ —Å—Ç–æ–∏—Ç –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏/–æ—á–∏—Å—Ç–∫–∏ –≤ peerService.
- –ù—É–∂–µ–Ω audit –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ–≥–æ –¥–≤–æ–π–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ discovery (–ª–æ–∫–∏/—Ñ–ª–∞–≥–∏ —Ä–µ–µ–Ω—Ç–µ—Ä–∞–±–µ–ª—å–Ω–æ—Å—Ç–∏ –≤ gameStore –ø—Ä–∏ –≤—ã–∑–æ–≤–∞—Ö).
- –í –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –º–µ—Å—Ç–∞—Ö –µ—Å—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç peerService API (getPeer, addConnection, hasConnection –∏ —Ç.–ø.) ‚Äî —Ç—Ä–µ–±—É–µ—Ç—Å—è —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç (—Å–º. peerService.ts).

## –ò–∑–º–µ–Ω–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–π –∑–∞–¥–∞—á–∏

- –î–æ–±–∞–≤–ª–µ–Ω –≥–ª–æ–±–∞–ª—å–Ω—ã–π debug-—Ñ–ª–∞–≥, —É–ø—Ä–∞–≤–ª—è–µ–º—ã–π —á–µ—Ä–µ–∑ localStorage –∫–ª—é—á "__app_debug".
- –°–æ–∑–¥–∞–Ω–∞ —É—Ç–∏–ª–∏—Ç–∞ src/utils/debug.ts:
  - isDebugEnabled(): –±–µ–∑–æ–ø–∞—Å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–ª–∞–≥–∞; true –ø—Ä–∏ –ª—é–±–æ–º –Ω–µ–ø—É—Å—Ç–æ–º –∑–Ω–∞—á–µ–Ω–∏–∏, –∫—Ä–æ–º–µ '0' | 'false' | 'off'; –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –≤–∞—Ä–∏–∞–Ω—Ç "__app_ns::__app_debug" –¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏.
  - enableDebug()/disableDebug(): —Ö–µ–ª–ø–µ—Ä—ã –¥–ª—è –≤–∫–ª—é—á–µ–Ω–∏—è/–æ—Ç–∫–ª—é—á–µ–Ω–∏—è —Ñ–ª–∞–≥–∞.
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ Pinia: –≤ src/stores/gameStore.ts –¥–æ–±–∞–≤–ª–µ–Ω –∏ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω computed isDebug = computed(() => isDebugEnabled()).
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö: v-if="game.isDebug" —á–µ—Ä–µ–∑ useGameStore().

## –ü—Ä–æ–≤–µ—Ä–∫–∞/—Ä–∏—Å–∫

- –í Lobby —É–∂–µ –±—ã–ª–∏ —É–ø—Ä–æ—â–µ–Ω–∏—è reconnect-–±–∞–Ω–Ω–µ—Ä–æ–≤; —Ç–µ–∫—É—â–µ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –≤—ã—Ä–æ–≤–Ω—è–ª–æ GameField —Å —Ç–æ–π –∂–µ –º–æ–¥–µ–ª—å—é (—Ç–æ–ª—å–∫–æ popup).
- –°—Ç–∏–ª–∏ .reconnect-info —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã; –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –º–æ–∂–Ω–æ –ø–æ–ª–Ω–æ—Å—Ç—å—é —É–±—Ä–∞—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø–æ–∑–∂–µ, –µ—Å–ª–∏ popup –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ –±–ª–æ–∫–∏—Ä—É–µ—Ç —Ñ–æ–Ω –∏ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –ø–æ–¥–ª–æ–∂–∫–∏.

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

- –û–±–µ—Ä–Ω—É—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –æ—Ç–ª–∞–¥–æ—á–Ω—ã–µ –ø–∞–Ω–µ–ª–∏/—ç–ª–µ–º–µ–Ω—Ç—ã –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö —É—Å–ª–æ–≤–∏–µ–º v-if="game.isDebug".
- –î–æ–±–∞–≤–∏—Ç—å –±—ã—Å—Ç—Ä—ã–π smoke‚Äë—Ç–µ—Å—Ç: –≤ –∫–æ–Ω—Å–æ–ª–∏ –≤—ã–ø–æ–ª–Ω–∏—Ç—å localStorage.setItem('__app_debug','1') –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–∏–¥–∏–º–æ—Å—Ç—å debug‚ÄëUI; –∑–∞—Ç–µ–º localStorage.removeItem('__app_debug') ‚Äî —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —Å–∫—Ä—ã–≤–∞–µ—Ç—Å—è.
- (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –î–æ–ø–æ–ª–Ω–∏—Ç—å e2e: —Å—Ü–µ–Ω–∞—Ä–∏–π, –ø—Ä–æ–≤–µ—Ä—è—é—â–∏–π —É—Å–ª–æ–≤–Ω—É—é –≤–∏–¥–∏–º–æ—Å—Ç—å —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–º —Ñ–ª–∞–≥–µ.
- (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –ü–æ–∫—Ä—ã—Ç—å unit‚Äë—Ç–µ—Å—Ç–æ–º utils/debug.ts (–ø–∞—Ä—Å–∏–Ω–≥ –∑–Ω–∞—á–µ–Ω–∏–π '0'/'false'/'off', –ø—É—Å—Ç–∞—è —Å—Ç—Ä–æ–∫–∞, –Ω–µ–ø—É—Å—Ç—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è).
